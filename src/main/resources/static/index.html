<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>ğŸ¬ Locadora</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<header>
    <h1>ğŸ¬ Locadora!</h1>
</header>

<main>
    <!-- Criar filme -->
    <section class="card">
        <h2>â• Adicionar Filme</h2>
        <input type="text" id="nome" placeholder="Nome do Filme">
        <input type="text" id="ano" placeholder="Ano de LanÃ§amento">
        <input type="text" id="diretor" placeholder="Diretor">
        <button onclick="criar()">Salvar ğŸ¥</button>
    </section>

    <!-- Buscar filme -->
    <section class="card">
        <h2>ğŸ” Buscar Filme</h2>
        <input type="text" id="buscarNome" placeholder="Nome do Filme">
        <button onclick="buscar()">Buscar ğŸ”</button>
        <pre id="resultadoBuscar"></pre>
    </section>

    <!-- Deletar filme -->
    <section class="card danger">
        <h2>ğŸ—‘ï¸ Deletar Filme</h2>
        <input type="text" id="deletarNome" placeholder="Nome do Filme">
        <button onclick="deletar()">Deletar âŒ</button>
    </section>

    <!-- Atualizar filme -->
    <section class="card">
        <h2>âœï¸ Atualizar Filme</h2>
        <input type="number" id="id" placeholder="ID">
        <input type="text" id="novoNome" placeholder="Novo Nome">
        <input type="text" id="novoAno" placeholder="Novo Ano">
        <input type="text" id="novoDiretor" placeholder="Novo Diretor">
        <button onclick="atualizar()">Atualizar ğŸ”„</button>
    </section>
</main>

<footer>
    <p>ğŸ¿ Locadora - Projeto Java - Gabriela Oliveira</p>
</footer>

<script>
    const api = "/filme";

    async function criar() {
      const resp = await fetch(api, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          nome: document.getElementById("nome").value,
          ano: document.getElementById("ano").value,
          diretor: document.getElementById("diretor").value
        })
      });
      alert(resp.ok ? "ğŸ‰ Filme adicionado!" : "âŒ Erro ao salvar!");
    }

    async function buscar() {
      const nome = document.getElementById("buscarNome").value;
      const resp = await fetch(`${api}?nome=${encodeURIComponent(nome)}`);
      if (resp.ok) {
        const data = await resp.json();
        document.getElementById("resultadoBuscar").innerText = JSON.stringify(data, null, 2);
      } else {
        document.getElementById("resultadoBuscar").innerText = "âŒ Filme nÃ£o encontrado!";
      }
    }

    async function deletar() {
      const nome = document.getElementById("deletarNome").value;
      const resp = await fetch(`${api}?nome=${encodeURIComponent(nome)}`, { method: "DELETE" });
      alert(resp.ok ? "ğŸ—‘ï¸ Filme deletado!" : "âŒ Erro ao deletar!");
    }

    async function atualizar() {
      const id = document.getElementById("id").value;
      const resp = await fetch(`${api}?id=${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          nome: document.getElementById("novoNome").value,
          ano: document.getElementById("novoAno").value,
          diretor: document.getElementById("novoDiretor").value
        })
      });
      alert(resp.ok ? "âœ… Filme atualizado!" : "âŒ Erro ao atualizar!");
    }
</script>
</body>
</html>
